# 似然函数与极大似然估计

## 1、似然函数

在数理统计学中，似然函数是一种关于统计模型中的参数的函数，表示模型参数中的似然性。

“似然性”与“或然性”或“概率”意思相近，都是指某种发生的可能性，但在统计学中，“似然性”和“概率”又有明确的区分。

* 概率：用于在已知一些参数的情况下，预测接下来在观测上所得到的结果。

* 似然性：用于在已知某些观测所得到的结果时，对有关事物之间的参数进行估值。

## 2、似然与概率的区别于联系 

* 似然函数的定义：给定输出x时，关于参数$\theta$的似然函数$L(\theta|x)$（在数值上）等于给定参数$\theta$后变量$x$的概率 ,公式如下：

$$L(\theta|x) = f(x|\theta)$$

**1.两者之间的区别**

从定义上，似然函数和概率密度函数是完全不同的两个**数学对象**：前者是关于$\theta$的函数，后者是关于$x$的函数。

所以等号=理解为**函数值形式**的相等，**而不是两个函数本身是同一函数。**
    

**2.两者之间的联系**

$\color{maroon}{<1>.}$ 如果$x$是离散的随机向量，那么其概率密度函数$f(x|\theta)$可改写为$f(x|\theta) = P_{\theta}(X=x)$，即代表了在参数$\theta$下随机向量$X$取到值$x$的可能性；

并且，如果我们发现$L({\theta_1|x}) = P_{\theta_1}(X=x) > P_{\theta_2}(X=x) = L({\theta_2}|X)$

那么**似然函数**就反应出这样一个**朴素推测**：在参数$\theta_1$下随机向量$X$取到值$x$的可能性**大于**在参数$\theta_2$下随机向量$X$取到值$x$的可能性。

换句话说，我们更有理由相信${\theta_1}$  更有可能是真实值。

$\color{maroon}{<2>.}$ 如果$X$是连续的随机向量，那么其密度函数$f(x|\theta)$本身在$x$处的概率为0，为了方便考虑一维情况：

给定一个充分小$\epsilon>0$，那么随机变量$X$取值在$(x-\epsilon,x+\epsilon)$区间内的概率即为

$P_{\theta}({x-\epsilon} < X < {x+\epsilon}) = \large\large\int_{x-\epsilon}^{x+\epsilon}f(x|\theta)dx \approx 2\epsilon f(x|\theta) = 2{\epsilon}L(\theta|x)$

而且在两个未知参数的情况下做比就能够约掉$2\epsilon$，所以和离散情况下的理解一致。只是此时似然所表达的那种可能性和概率$f(x|\theta)=0$无关


**3.总结**         

 综上，概率表达的是给定$\theta$下样本随机向量$X=x$的可能性，而似然表达了给定样本$X=x$下参数$\theta_1$（相对于$\theta_2$）为真实值的可能性。

最后再回到$L(\theta|x) = f(x|\theta)$这个表达式。首先对符号要严格，竖线$|$表示条件概率或条件分布，而分号；则表示把参数隔开。

所以这个式子的严格书写为$L(\theta|x) = f(x;\theta)$ 因为$\theta$在右边的式子中只能当做参数理解

**引用：**
            
        https://www.zhihu.com/question/54082000
        https://baike.baidu.com/item/%E4%BC%BC%E7%84%B6%E5%87%BD%E6%95%B0
        https://zh.wikipedia.org/wiki/%E4%BC%BC%E7%84%B6%E5%87%BD%E6%95%B0


## 3、最大似然函数估计（极大似然函数估计）
有了似然函数，就可以用似然函数来估计模型的参数了。我们要求得**参数就是使似然函数取极大值的参数**

**假设投掷硬币100次，正面53次，每次正面朝上的概率为$P_H$，则似然函数可以表达为**
$L(X|\theta) = C_{53}^{100}P_H^{53} \times (1-P_H)^{47}$

可知，$P_H$一阶导数为0时，函数取最大值，则：
${\large dL \over {dP_H}} = C_{53}^{100} \times \{53P_H^{52} \times (1-P_H)^{47} + P_H^{53}(1-P_H)^{46} \times (-47)  \}$

令 ${\large dL \over {dP_H} }= 0$ ，因此可得，$P_H = 0.53$

**把极大似然估计推广到更一般的情况：假设投硬币$n$次，正面出现$n_1$次**

**第一步写出似然函数**

$L(X|\theta) = C_{n1}^{n} \times P_H^{n1} \times (1-P_H)^{n-n1}$

**第二步对似然函数求导**

${\large dL \over {dP_H}} = C_{n1}^{n} \times \{n1P_H^{n1-1} \times (1-P_H)^{n-n1} + P_H^{n1}(1-P_H)^{n-n1-1} \times (-n+n1)  \}$

所以 $P_H = {n1 \over n}$

