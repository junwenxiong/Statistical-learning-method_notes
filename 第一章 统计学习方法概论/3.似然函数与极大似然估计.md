# 1. 似然函数与极大似然估计

## 1.1. 1、似然函数

在数理统计学中，似然函数是一种关于统计模型中的参数的函数，表示模型参数中的似然性。 （**参数$\theta$为分布的参数**）

“似然性”与“或然性”或“概率”意思相近，都是指某种发生的可能性，但在统计学中，“似然性”和“概率”又有明确的区分。

* 概率：用于在已知一些参数的情况下，预测接下来在观测上所得到的结果。

* 似然性：用于在已知某些观测所得到的结果时，对有关事物之间的参数进行估值。

## 1.2. 2、似然与概率的区别于联系 

* 似然函数的定义：给定输出x时，关于参数$\theta$的似然函数$L(\theta|x)$（在数值上）等于给定参数$\theta$后变量$x$的概率 ,公式如下：

$$L(\theta|x) = f(x|\theta)$$

**1.两者之间的区别**

从定义上，似然函数和概率密度函数是完全不同的两个**数学对象**：前者是关于$\theta$的函数，后者是关于$x$的函数。

所以等号=理解为**函数值形式**的相等，**而不是两个函数本身是同一函数。**
    

**2.两者之间的联系**

$\color{maroon}{<1>.}$ 如果$x$是离散的随机向量，那么其概率密度函数$f(x|\theta)$可改写为$f(x|\theta) = P_{\theta}(X=x)$，即代表了在参数$\theta$下随机向量$X$取到值$x$的可能性；

并且，如果我们发现$L({\theta_1|x}) = P_{\theta_1}(X=x) > P_{\theta_2}(X=x) = L({\theta_2}|X)$

那么**似然函数**就反应出这样一个**朴素推测**：在参数$\theta_1$下随机向量$X$取到值$x$的可能性**大于**在参数$\theta_2$下随机向量$X$取到值$x$的可能性。

换句话说，**我们更有理由相信${\theta_1}$  更有可能是真实值。**

$\color{maroon}{<2>.}$ 如果$X$是连续的随机向量，那么其密度函数$f(x|\theta)$本身在$x$处的概率为0，为了方便考虑一维情况：

给定一个充分小$\epsilon>0$，那么随机变量$X$取值在$(x-\epsilon,x+\epsilon)$区间内的概率即为

$P_{\theta}({x-\epsilon} < X < {x+\epsilon}) = \large\large\int_{x-\epsilon}^{x+\epsilon}f(x|\theta)dx \approx 2\epsilon f(x|\theta) = 2{\epsilon}L(\theta|x)$

而且在两个未知参数的情况下做比就能够约掉$2\epsilon$，所以和离散情况下的理解一致。只是此时似然所表达的那种可能性和概率$f(x|\theta)=0$无关


**3.总结**         

 综上，概率表达的是给定$\theta$下样本随机向量$X=x$的可能性，而似然表达了给定样本$X=x$下参数$\theta_1$（相对于$\theta_2$）为真实值的可能性。

最后再回到$L(\theta|x) = f(x|\theta)$这个表达式。首先对符号要严格，竖线$|$表示条件概率或条件分布，而分号；则表示把参数隔开。

所以这个式子的严格书写为$L(\theta|x) = f(x;\theta)$ 因为$\theta$在右边的式子中只能当做参数理解

**引用：**
            
        https://www.zhihu.com/question/54082000
        https://baike.baidu.com/item/%E4%BC%BC%E7%84%B6%E5%87%BD%E6%95%B0
        https://zh.wikipedia.org/wiki/%E4%BC%BC%E7%84%B6%E5%87%BD%E6%95%B0


## 1.3. 3、最大似然函数估计（极大似然函数估计）
有了似然函数，就可以用似然函数来估计模型的参数了。我们要求得**参数就是使似然函数取极大值的参数**

### 1.3.1. 3.1离散分布，离散有限参数空间

样本$X$属于$X \sim b(1,P_H)$

**假设投掷硬币100次，正面53次，每次正面朝上的概率为$P_H$，则似然函数可以表达为**

$L(P_H|X) = C_{53}^{100}P_H^{53} \times (1-P_H)^{47}$

可知，$P_H$一阶导数为0时，函数取最大值，则：

${\large{ dL \over {dP_H}} = C_{53}^{100} \times \{53P_H^{52} \times (1-P_H)^{47} + P_H^{53}(1-P_H)^{46} \times (-47)  \}}$

令 ${\large{ dL \over {dP_H} }}= 0$ ，因此可得，$P_H = 0.53$


### 1.3.2. 3.2离散分布，连续参数空间
样本$X$属于$X \sim b(1,P_H)$

**把极大似然估计推广到更一般的情况：假设投硬币$n$次，正面出现$n_1$次，且$0 \leq P_H<1$**

**第一步写出似然函数**

$\large{L(P_H|X) = C_{n1}^{n} \times P_H^{n1} \times (1-P_H)^{n-n1}}$

**第二步对似然函数求导**

${\large {dL \over {dP_H}} = C_{n1}^{n} \times \{n1P_H^{n1-1} \times (1-P_H)^{n-n1} + P_H^{n1}(1-P_H)^{n-n1-1} \times (-n+n1)  \}}$

所以 $\large{P_H = {n1 \over n}}$

也就是任何成功次数为$n1$，试验总数为$n$的伯努利试验

### 1.3.3. 3.3连续分布，连续参数空间
   最常见的连续概率分布是**正态分布$X \sim N(\mu,\sigma^2)$**，其**概率密度函数**如下：

![](_v_images/20200210232845882_19018.png =441x)


其$n$个正态随机变量的采样的对应密度函数（假设其独立并服从同一分布）为：

![](_v_images/20200210232304602_10222.png =614x)

或下面的式子，下面的式子由结果所推导出来

![](_v_images/20200211103057221_872.png =763x)

<br>

接下来，我们要开始分析上面的公式，就拿第二个公式来说吧，$\color{red}{其中含有 \mu 与 \sigma^2 这两个参数，为了避免疑问，将两个参数放入到一个参数中。 \large{\theta = (\mu, \sigma^2)}}$

通过观察我们可以发现，最大化一个似然函数同最大化它的自然对数是等价的。<font color="red">因为自然对数$log$是一个连续且在似然函数的值域内严格递增的函数。</font>

**先对$\mu$进行求导，使其为零：**


![](_v_images/20200211104000483_31803.png =601x)


解得$\color{red}{\large{\hat \mu  = \overline x = {\sum_{i=1}^n \frac{x_i}{n}}}}$

**同理，对$\sigma$求导，并使其为零**

![](_v_images/20200211104625959_31584.png =570x)

解是$\color{red}{\large{\hat \sigma^2 = \sum_{i=1}^n \frac{(x_i - \hat \mu)^2}{n}}}$

因此，关于$\color{red}{\large{\hat \theta = (\hat \mu, \hat \sigma^2) = (\overline x, \sum_{i=1}^n \frac{(x_i - \overline x)^2}{n})}}$



### 1.3.4. 3.4 最大似然估计的一般求解步骤

**首先，我们要了解样本属于什么分布，比如二项分布，正态分布，均匀分布**

**<1>.写出似然函数，$\theta$属于分布中的参数**

$\large{L(\theta|X) = \prod_{i=1}^n p(x_i;\theta)}$ （总体$X$为离散型时）

$\large{L(\theta|X) = \prod_{i=1}^n f(x_i ;\theta)}$（总体$X$为连续型时）


**<2>.对似然函数两边取对数**

$\large{\ln L(\theta| X) = \sum_{i=1}^n \ln p(x_i;\theta)}$

$\large{\ln L(\theta| X) = \sum_{i=1}^n \ln f(x_i; \theta)}$


**<3>.对上式求导数并令之为零**

$\large{\frac {d \ln L(\theta | X)}{d\theta} =0}$

解对数似然方程所得，即为未知数的最大似然估计值

**引用**

    https://wiki.mbalib.com/wiki/%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1